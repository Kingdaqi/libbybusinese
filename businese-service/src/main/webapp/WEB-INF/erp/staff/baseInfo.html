<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>开启头部工具栏 - 数据表格</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="../../layui-v2.4.3/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="../../layui-v2.4.3/style/admin.css" media="all">
    <script src="../../js/jquery-1.7.2.js"></script>
    <script defer="false">
        //登录成功后,但要在页面加载前加载左侧菜单栏
        $(document).ready(function() {
            var username = $('.layui-input-search').val();
            $.ajax({
                type: "POST",
                url: 'getStaffs',
                data: {username:username,page:0,rows:5},
                dataType:'json',
                cache: false,
                async:false,
                success: function(data){
                    if(data.data!=null){
                        alert(data.data);
                        //handleMenu(data.data);
                    }
                }
            });
        });
        //拼接左侧菜单栏代码
        function handleMenu(data){
            var lis = "";
            $.each(data,function (index,item) {
                lis += "<li data-name=\""+item.curl+"\" class=\"layui-nav-item\">\n" +
                    "            <a href=\"javascript:;\">\n" +
                    "                <i class=\"layui-icon "+item.ico+"\"></i>\n" +
                    "            <cite>"+item.name+"</cite>\n" +
                    "            </a>\n" +
                    "            <dl class=\"layui-nav-child\">\n";

                $.each(item.children,function(index2,itemChild){
                    lis += "                <dd>\n" +
                        "                    <a data-url=\""+itemChild.curl+"\" data-id=\""+itemChild.component+"\" data-title=\""+itemChild.name+"\" href=\"#\" class=\"site-demo-active\" data-type=\"tabAdd\">"+itemChild.name+"</a>\n" +
                        "                </dd>\n";
                })

                lis += "            </dl>\n" +
                    "        </li>";
            })
            $('ul#LAY-system-side-menu').append(lis);

        }
    </script>
</head>
<body>

<div class="layui-card layadmin-header">
    <div class="layui-breadcrumb" lay-filter="breadcrumb">
        <a lay-href="">主页</a>
        <a><cite>组件</cite></a>
        <a><cite>数据表格</cite></a>
        <a><cite>开启头部工具栏</cite></a>
    </div>
</div>

<div class="layui-fluid">
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md12">
            <div class="layui-card">
                <!--<div class="layui-card-header">开启头部工具栏</div>-->
                <div class="layui-card-body">
                    <table class="layui-show" id="test-table-toolbar" lay-filter="test-table-toolbar"></table>

                    <div class="layui-form layui-border-box layui-table-view" lay-filter="LAY-table-1" style=" ">
                        <div class="layui-table-tool">

                            <button class="layui-btn layui-btn-sm1 layui-btn-normal">新增</button>
                            <input type="text" placeholder="用户名..." autocomplete="off" class="layui-input-search"
                                   layadmin-event-search="serach" lay-action="template/search.html?keywords="/>
                            <button class="layui-btn layui-btn-sm1 layui-btn-normal">搜索</button>

                            <div class="layui-table-tool-self">
                                <div class="layui-inline" title="筛选列" lay-event="LAYTABLE_COLS"><i
                                        class="layui-icon layui-icon-cols"></i></div>
                                <div class="layui-inline" title="导出" lay-event="LAYTABLE_EXPORT"><i
                                        class="layui-icon layui-icon-export"></i></div>
                                <div class="layui-inline" title="打印" lay-event="LAYTABLE_PRINT"><i
                                        class="layui-icon layui-icon-print"></i></div>
                            </div>
                        </div>
                        <div class="layui-table-box">

                            <div class="layui-table-header">
                                <table cellspacing="0" cellpadding="0" border="0" class="layui-table">
                                    <thead>
                                    <tr>
                                        <th data-field="id" data-key="1-0-1" data-unresize="true"
                                            class=" layui-unselect" style="width: 200px">
                                            <div class="layui-table-cell" style="width: 200px"><span>ID</span><span
                                                    class="layui-table-sort layui-inline"><i
                                                    class="layui-edge layui-table-sort-asc" title="升序"></i><i
                                                    class="layui-edge layui-table-sort-desc" title="降序"></i></span>
                                            </div>
                                        </th>
                                        <th data-field="username" data-key="1-0-2" class="" style="width: 200px">
                                            <div class="layui-table-cell" style="width: 200px"><span>用户名</span></div>
                                        </th>
                                        <th data-field="name" data-key="1-0-3" class="" style="width: 200px">
                                            <div class="layui-table-cell" style="width: 200px"><span>姓名</span></div>
                                        </th>
                                        <th data-field="dept" data-key="1-0-4" class="" style="width: 200px">
                                            <div class="layui-table-cell" style="width: 200px"><span>所属部门</span></div>
                                        </th>
                                        <th data-field="roles" data-key="1-0-5" class="" style="width: 200px">
                                            <div class="layui-table-cell" style="width: 200px"><span>角色</span></div>
                                        </th>
                                        <th data-field="11" data-key="1-0-6" class=" layui-table-col-special" style="width: 200px">
                                            <div class="layui-table-cell" style="width: 200px"><span>操作</span></div>
                                        </th>
                                    </tr>
                                    </thead>
                                </table>
                            </div>

                            <div class="layui-table-body" onscroll="ceshi()">
                                <table cellspacing="0" cellpadding="0" border="0" class="layui-table">
                                    <tbody>
                                    <tr data-index="0" class="">
                                        <td data-field="id" data-key="1-0-1" class="" style="width: 200px">
                                            <div class="layui-table-cell" style="width: 200px">10001</div>
                                        </td>
                                        <td data-field="username" data-key="1-0-2" data-edit="text" class="" style="width: 200px">
                                            <div class="layui-table-cell" style="width: 200px">dafu</div>
                                        </td>
                                        <td data-field="name" data-key="1-0-3" data-edit="text" class="" style="width: 200px">
                                            <div class="layui-table-cell" style="width: 200px">杜甫</div>
                                        </td>
                                        <td data-field="dept" data-key="1-0-4" data-edit="text" class="" style="width: 200px">
                                            <div class="layui-table-cell" style="width: 200px">销售部</div>
                                        </td>
                                        <td data-field="roles" data-key="1-0-5" data-edit="text" class="" style="width: 200px">
                                            <div class="layui-table-cell" style="width: 200px">销售经理</div>
                                        </td>
                                        <td data-field="11" data-key="1-0-6" data-off="true"
                                            class="layui-table-col-special" style="width: 200px">
                                            <div class="layui-table-cell" style="width: 200px">
                                                <a class="layui-btn layui-btn-warm layui-btn-xs" lay-event="edit">查看</a>
                                                <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
                                                <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
                                            </div>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>

                        </div>

                        <div class="layui-table-page">
                            <div id="layui-table-page1">
                                <div class="layui-box layui-laypage layui-laypage-default" id="layui-laypage-">
                                    <a href="javascript:;" class="layui-laypage-prev layui-disabled" data-page="0">上一页</a>
                                    <span class="layui-laypage-curr">
                                        <em class="layui-laypage-em"></em>
                                        <em>1</em>
                                    </span>
                                    <a href="javascript:;" data-page="2">2</a>
                                    <a href="javascript:;" data-page="3">3</a>
                                    <span class="layui-laypage-spr">…</span>
                                    <a href="javascript:;" class="layui-laypage-last" title="尾页" data-page="300000">30</a>
                                    <a href="javascript:;" class="layui-laypage-next" data-page="2">下一页</a>
                                    <span class="layui-laypage-skip">到第
                                        <input type="text" min="1" value="1" class="layui-input">页
                                        <button type="button" class="layui-laypage-btn">确定</button>
                                    </span>
                                    <span class="layui-laypage-count">共 30 条</span>
                                </div>
                            </div>
                        </div>

                    </div>

                    <script type="text/html" id="test-table-toolbar-barDemo">
                        <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
                        <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
                    </script>

                </div>
            </div>
        </div>
    </div>
</div>

<script src="../../layui-v2.4.3/layui/layui.js"></script>
<!--<script src="../js/jquery.min.js"></script>-->
<script>
    layui.config({
        base: '../../layui-v2.4.3/' //静态资源所在路径
    }).extend({
        index: 'lib/index' //主入口模块
    }).use(['index', 'table'], function () {
        var admin = layui.admin
            , table = layui.table;

        table.render({
            elem: '#test-table-toolbar'
            , url: layui.setter.base + 'json/table/demo.js'
            , toolbar: '#test-table-toolbar-toolbarDemo'
            , title: '用户数据表'
            , cols: [[
                {type: 'checkbox', fixed: 'left'}
                , {field: 'id', title: 'ID', width: 80, fixed: 'left', unresize: true, sort: true}
                , {field: 'username', title: '用户名', width: 120, edit: 'text'}
                , {
                    field: 'email', title: '邮箱', width: 150, edit: 'text', templet: function (res) {
                        return '<em>' + res.email + '</em>'
                    }
                }
                , {field: 'sex', title: '性别', width: 80, edit: 'text', sort: true}
                , {field: 'city', title: '城市', width: 100}
                , {field: 'sign', title: '签名'}
                , {field: 'experience', title: '积分', width: 80, sort: true}
                , {field: 'ip', title: 'IP', width: 120}
                , {field: 'logins', title: '登入次数', width: 100, sort: true}
                , {field: 'joinTime', title: '加入时间', width: 120}
                , {fixed: 'right', title: '操作', toolbar: '#test-table-toolbar-barDemo', width: 150}
            ]]
            , page: true
        });

        //头工具栏事件
        table.on('toolbar(test-table-toolbar)', function (obj) {
            var checkStatus = table.checkStatus(obj.config.id);
            switch (obj.event) {
                case 'getCheckData':
                    var data = checkStatus.data;
                    layer.alert(JSON.stringify(data));
                    break;
                case 'getCheckLength':
                    var data = checkStatus.data;
                    layer.msg('选中了：' + data.length + ' 个');
                    break;
                case 'isAll':
                    layer.msg(checkStatus.isAll ? '全选' : '未全选');
                    break;
            }
            ;
        });

        //监听行工具事件
        table.on('tool(test-table-toolbar)', function (obj) {
            var data = obj.data;
            if (obj.event === 'del') {
                layer.confirm('真的删除行么', function (index) {
                    obj.del();
                    layer.close(index);
                });
            } else if (obj.event === 'edit') {
                layer.prompt({
                    formType: 2
                    , value: data.email
                }, function (value, index) {
                    obj.update({
                        email: value
                    });
                    layer.close(index);
                });
            }
        });

    });

    function ceshi() {
        var header = $('.layui-table-header');
        var body = $('.layui-table-body');

        header.scrollTop = body.scrollTop;
    }

</script>
</body>
</html>


